# ProcessNewMessages Process 

[English](ProcessNewMessages.md) | [Русский](ProcessNewMessages.ru.md)

## Описание 

- Обрабатывает сообщения от пользователей:
    - Получает сообщение от отправителя;
    - Записывает сообщение в БД `MessagingDB`;
    - Если получатель онлайн и не проставлено "Отключить уведомления" для этого чата, то отправляем сообщение:
        - Если сообщение отправлено, то помечаем сообщение как "отправлено".
        - Если не получается отправить, то помечаем сообщение как "ожидающее отправку", ставим статус получателя оффлайн и отправляем информацию о статусе по RabbitMQ на сервис **Last seen service**.
    - Если получатель оффлайн, то помечаем сообщение как "ожидающее отправку".

![ProcessNewMessagesDiagram](../../../img/ActivityDiagrams/ProcessNewMessagesDiagram.png)
