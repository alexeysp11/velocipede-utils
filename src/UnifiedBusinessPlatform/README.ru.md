# UnifiedBusinessPlatform

[English](README.md) | [Русский](README.ru.md)

Этот проект предполагает создание программного приложения, которое может эффективно обрабатывать данные об отпусках сотрудников и управлять ими, а также предоставлять информацию о переходах в отпуск на основе определенных критериев.

## Требования

1. Сгенерировать случайным образом "сотрудников компании": 100 объектов пользователь (ФИО, пол, должность (перечисление 10 должностей), возраст). 
2. Сгенерировать случайным образом "график отпусков": 3 объекта "отпуск" (дата начала, дата окончания, объект пользователь) длиной 14,7,7 дней для каждого созданного пользователя в текущем году. 
3. Запросить ввод "нового отпуска" текущего сотрудника. Длина нового отпуска не более 14 дней. 
4. Вывести информацию о пересечениях отпусков по критериям: 
    - Пересечение отпуска с сотрудниками моего отдела. Сотрудники моложе 30 лет. 
    - Пересечение отпуска с сотрудниками-женщинами не из моего отдела. Возраст сотрудников - старше 30, но моложе 50. 
    - Пересечение отпуска с сотрудниками из любого отдела. Возраст сотрудников - старше 50 лет. 
    - Отпуска без пересечения. 
5. Желательно использование LINQ, лямбда-выражений.
6. Желательно выбрать максимально производительный алгоритм определения пересечений. 

## Начало работы

В рамках данного проекта есть утилита (консольное приложение [DbInit](WorkflowLib.UnifiedBusinessPlatform.DbInit)), которая инициализирует БД для того, чтобы у пользователя было впечатление, что он работает с полноценным коммерческим приложением. Эта утилита должна запускаться в момент начала работы над проектом.

### Объектная модель

Для работы с БД используется EF Core, и для большей части функционала приложения уже реализована объектная модель в [Models.Business](../Shared/Models.Business). При необходимости изменений лучше придерживаться подхода **Code-first**, т.е. сначала изменить класс, а потом выполнить миграцию и применить её к БД.

Из-за того, что полноценное использование данного приложения невозможно при пустой базе данных, то в самом начале наблюдалась небольшая путаница в использовании подходов для работы с БД. Сначала выполнялись первые миграции на основе моделей из `Models.Business`. Таким образом, в БД были созданы соответствующие таблицы, а потом эти таблицы заполнялись данными (в основном, данными об организационной структуре сразу нескольких компаний).

Поскольку данных было очень много, данные были запутанными, а сам процесс заполнения данными занял пару недель, то возникла идея выполнить dump базы данных, чтобы инициализировать базу данных одним скриптом и сэкономить время. Вследствии такого решения появилась путанница между подходами к работе с базой данных и объектной моделью: стало непонятно, что мы используем - **Code-first** и **Database-first**. Для того, чтобы стабилизировать ситуацию, было принято решение создать утилиту [DbInit](WorkflowLib.UnifiedBusinessPlatform.DbInit) для автоматической инициализации базы данных. 

Поэтому существует рекомендация: в самом начале работы над приложением сначала использовать утилиту [DbInit](WorkflowLib.UnifiedBusinessPlatform.DbInit) для иницилизации вашей БД, а потом продолжать работу с объектами в рамках подхода **Code-first**.

Исходя из этого, возникли дополнительные правила для выполнения изменений:

- Когда вы выполнили изменения в объектной модели или процедурах БД, то необходимо сохранять всю информацию об изменениях в системе контроля версий (в том числе все EF Core миграции и SQL-скрипты).
- Если был создан SQL-скрипт, то нужно в [DbInit](WorkflowLib.UnifiedBusinessPlatform.DbInit) добавить путь к новому SQL-скрипту в конец списка действий для инициализации. В противном случае ваши изменения не будут применяться автоматически, в результате чего возможны ошибки у пользователей, которые будут использовать ваши изменения.

## Примеры использования

Сотрудники:

![employees_nofilter](../../docs/img/examples/UnifiedBusinessPlatform/employees_nofilter.png)

Отпуска:

![vacations_nofilter](../../docs/img/examples/UnifiedBusinessPlatform/vacations_nofilter.png)
