# Доработки

В текущей задаче выполнены все задачи, необходимые для генерации данных. Дальнейшая работа разбита на несколько задач.

Среди дальнейших доработок можно выделить:
- [x] Переименовать проект из `EmployeesMvc` в `UnifiedBusinessPlatform`.
- [x] Авторизация.
- [ ] Фильтрация данных о сотруднике и его отсутствиях.
- [ ] Role mechanism.
- [ ] Working hours, absences, salary.
- [ ] Notifications.
- [ ] Календарь отпусков.
- [ ] Написание тестовых сценариев с использованием рандомной генерации сотрудников и их отпусков.
- [x] Переписывание документации в `README.md` под новые требования приложения.

## Фильтрация данных

Подготовка:
- [x] Перенести UBP в src, т.к. это уже не "пример", а полноценный проект.
- [x] Переименовать namespaces в UnifiedBusinessPlatform.
- [x] Определиться с подходом к обновлению данных: "database first" vs "code first", чтобы изменения были консистентны (вроде для бизнес платформы более актуален "database first").
- [x] Добавить `IsPaid` в `Absenses`.
- [x] Получать из БД коллекцию надписей для визуальных компонентов, чтобы осуществить поддержку языков.
    - [x] Написать метод `GetLanguageKvpByFormName` для получения словаря с содержанием контролов (входные параметры: язык, наименование формы/страницы, UID приложения; выходные параметры: словарь, в котором ключ - наименование контрола, а значение - содержание контрола). Метод должен преобразовать полученные данные к типу `Dictionary<string, string>`.
    - [x] Создать функцию `GetLanguageKvpByFormName` в БД:
        - Входные параметры: такие же как у метода; выходные параметры: коллекция `LanguageKeyValuePair`.
        - Надо в БД по наименованию формы/страницы взять список актуальных ключей (наименований контролов).
        - По указанному языку, для каждого ключа найти актуальные `LanguageKeyValuePair`.
    - [x] Протестировать метод `GetLanguageKvpByFormName`.
    - [x] Из `cshtml` вызывать метод `GetLanguageKvpByFormName`; вернется словарь. Далее в `cshtml`, как и ранее, получать содержание контрола по ключу (обращаться к полученному словарю).
- [x] Заполнить языковые таблицы по данным из конфига.
- [x] Заполнить данные в `"LanguageKeyForms"`: открыть каждый из файлов View, находить по `_appSettings.Translate`.
- [ ] Полностью заменить `_appSettings.Translate` на `GetLanguageKvpByFormName`.
    - [ ] Разобраться, как можно использовать `ViewComponent` с кэшированием (для перевода на странице `_Layout.cshtml`).
    - [ ] Разобраться, как можно использовать сервис и кэширование на уровне сервиса (для перевода на странице `_Layout.cshtml`).
- [x] Добавить описания для страниц:
    - [x] **Home**: вместо "Employee Management System" использовать "UnifiedBusinessPlatform"; "Добро пожаловать в единую платформу управления компанией. Здесь вы найдете общую сводку данных, уведомления и ссылки на ключевые разделы".
    - [x] **Brief description**: "Краткое описание организационной структуры"; "Найдите нужную информацию об организационной структуре вашей компании, включая иерархию, контакты и обязанности"; если пользователь не авторизован, то написать "Войдите в систему для того, чтобы иметь доступ к информации".
    - [x] **Internal documentation**: "Централизованное хранилище всех внутренних документов компании. Быстрый поиск и удобный доступ к необходимым материалам".
    - [x] **Employees**: "Управление списком сотрудников компании", "Полный список сотрудников компании с возможностью просмотра и редактирования личной информации, должностей и контактных данных. Для руководителей и HR-специалистов доступно ведение и учет трудовых договоров и кадровых перемещений".
    - [x] **Investments**: "Раздел управления инвестициями компании", "Планируйте бюджет, отслеживайте затраты и инвестиции, формируйте финансовые отчеты".
    - [x] **Hiring specialists**: "Раздел управления процессом найма персонала"; "Публикуйте вакансии, отслеживайте кандидатов, проводите собеседования и управляйте процессом найма от начала до конца".
    - [x] **Notifications**: "Центр уведомлений и оповещений системы"; "Получайте своевременные уведомления о важных событиях и изменениях в системе, не пропуская ничего важного. Управляйте вашими уведомлениями, чтобы быть в курсе всех событий компании, которые могут вас интересовать".
- [x] Добавить карточку сотрудника: должны быть ссылки на карточку сотрудника на странице `Employees` и `Absenses`.
- [x] Использовать таблицу `"LanguageKeys"` вместо `_appSettings.Languages` для получения списка доступных языков
    - [x] добавить свойство `BusinessEntityStatus` для того, чтобы "включать" и "выключать" отображение языка.
    - [x] заполнить таблицу `"LanguageKeys"` данными.
    - [x] заменить `_appSettings.Languages` на `"LanguageKeys"`.
- [x] Перевести элементы в подменю "Больше".

Основное:
- [ ] Использовать `EmployeeViewModel` вместо класса `Employee`, потому что он не позволяет в явном виде сохранить информацию о должности, команде и департаменте.
- [ ] Из `AbsenseViewModel` можно получить экземпляр класса `EmployeeViewModel`.
- [ ] Для сотрудника (класс `Employee`) добавить поле `DateOfHiring`.
- [ ] Доделать фильтры для отсутствий.
    - [ ] Дополнительные поля для фильтрации: "Job title", "Team", "Department" (текстовые поля, фильтровать по наличию в поле `OrganizationItem` текста из этих полей).

## Утилита для обновления/инициализации базы данных

- [x] Написать утилиту, которая инициализирует приложение данными (использовать скрипты: SQL и `dotnet ef database update`).
    - [x] Добавить описание в репозиторий о том, как работать с объектной моделью.
    - [x] На основании описанной последовательности, реализовать создание и обновление базы данных.

## Role mechanism

- Подготовить следующие группы пользователей:
    - `User`: Обычный пользователь, имеющий минимальные права доступа.
    - `SystemAdministrator`: Системный администратор (редактирование групп пользователей).
    - `Manager`: Начальники; имеют возможность смотреть и устанавливать зарплату своих подчиненных (для изменения зарплаты должна быть цепочка согласования, состоящая из руководителя, руководителя департамента, руководителя HR, главного внутреннего финансиста, директора компании).
    - `Hr`: HR, который занимается преимущественно внутренними коммуникациями; имеет возможность смотреть обезличенную статистику по зарплатам сотрудников, создавать опросы удовлетворенности сотрудников.
    - `HrRecruiter`: Отвечает за найм специалистов, создание опросов удовлетворенности кандидатов.
    - `Finance`: Финансист, имеющий общие права доступа.
    - `FinanceSalary`: Финансист, имеющий права доступа для работы с зарпалатами сотрудников.
    - `TestNotifications`: Тестовая группа для тестирования уведомлений (отправка уведомлений самому себе).
- При авторизации получать записи из `"UserGroups"` и сохранять их в cookies в виде строки (например, `User`, `User;SystemAdministrator`, `User;Manager`).
- Для системных администраторов добавить страницу для того, чтобы редактировать группы пользователей: добавление пользователей в группы, удаление пользователей из групп.
- Depending on the department or job position, a **role mechanism** should be implemented within the authorization. With this, you can **allow or prohibit different actions for different users**: for example, adding/editing/deleting another employee's absence. The permissions for certain actions for roles should be specified in the corresponding table. You can use the `"UserGroups"` and `"UserAccountGroups"` tables, and, based on the data from these tables, set the required roles and access levels at the `UnifiedBusinessPlatform` application level.

## Написание тестовых сценариев с использованием рандомной генерации сотрудников и их отпусков

- Рандомная генерация позволит не использовать подключение к БД напрямую при тестировании.
- Использования единого контракта для фильтрации данных на тестах и на веб-проекте.
- Продумать архитектурный подход, при котором можно будет делать mock-объекты для модуля фильтрации данных.

## Переписывание документации в `README.md` под новые требования приложения

- Какие функции есть у приложения.
- Как использовать SQL-скрипты для заполнения БД.
- Чем отличается архитектура для тестирования приложения от архитектуры для использования приложения.
